{% extends "dashboard/base.html" %}
{% load static %}


{% block title %}
  Petient | List
{% endblock title %}

{% block custom_css %}
<style>
    .btn-fab-fixed {
        right: calc(25% - 60px);
    }
    
    .btn-fab-fixed {
      position: absolute;
      top: 98px;
      right: 25%;
  }


    .btn-fab-default:hover{
        background-color: #26a5d4;
    }

    .btn-fab-default:hover{
       box-shadow: 0 3px 3px 0 rgba(0,0,0,.14),0 1px 7px 0 rgba(0,0,0,.12),0 3px 1px -1px rgba(0,0,0,.2);
    }

    .waves-effect {
        position: relative;
        cursor: pointer;
        display: inline-block;
        overflow: hidden;
        -webkit-user-select: none;
        -moz-user-select: none;
        -ms-user-select: none;
        user-select: none;
        -webkit-tap-highlight-color: transparent;
        vertical-align: middle;
        z-index: 1;
        transition: .3s ease-out;
    }

    .btn-fab-default {
        height: 54px;
        line-height: 54px;
        width: 56px;
    }
    
   
    .btn-fab-default {
        display: inline-block;
        color: #fff;
        position: relative;
        overflow: hidden;
        z-index: 1;
        width: 40px;
        height: 40px;
        line-height: 40px;
        padding: 0;
        background-color: #26a5d4;
        border-radius: 50%;
        transition: .3s;
        cursor: pointer;
        vertical-align: middle;
    }
 
    .btn-fab-default {
        text-decoration: none;
        color: #fff;
        background-color: #26a5d4;
        text-align: center;
        letter-spacing: .5px;
        transition: .2s ease-out;
        cursor: pointer;
    }

    .btn-fab-default svg {
        vertical-align: middle;
    }

    svg:not(:root) {
        overflow: hidden;
    }
    </style>
{% endblock %}

{% block breadcrumbs %}
  <ul class="breadcrumbs">
    <li class="visible-s">
        Petients
    </li>
  </ul>
{% endblock %}

{% block header_extra %}
  <div class="btn-fab-fixed">
    <a href="{% url 'dashboard:petient-create' %}" class="btn-fab-default waves-effect waves-light" >
    <svg fill="#ffffff" height="24" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" role="img" data-src="/static/admin/img/add.svg" class="injected-svg">
        <path d="M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z" role="presentation"></path>
        <path d="M0 0h24v24H0z" fill="none" role="presentation"></path>
    </svg>
    </a>
  </div>
{% endblock %}

{% block content %}
<table class="table table-light table-striped" id="list_table">
    <thead>  
        <tr>
            <th>Name</th>
            <th>Date of Birth</th>
            <th colspan="2">Action</th>
        </tr>      
    </thead>
    <tbody>

    </tbody>
</table>
{% endblock %}

{% block extra_script %}
<script>
function myfunction(id) {
    var pk = id;
    var data = {
        "csrfmiddlewaretoken":$("input[name='csrfmiddlewaretoken']").val()
    };
    $.ajax({
        url: "/dashboard/delete/"+pk+"/",
        type: "GET",
        data: data,
        contentType: "application/json; charset=utf-8",
        dataType: "json",
        success: function (data) {
            if (data['success']){
            // $("#list_table").load(window.location + " #list_table");
            $('#tr_'+id).remove();
            
            }
        }
    });
}

$(document).ready(function () { 
    $.ajax({
       type : "GET", 
       url: "{% url 'dashboard:list' %}",
       data: {
       },
       
       success: function(data){
        $.each(data, function(key,val) {
            $('#list_table').append(
                    '<tr id="tr_'+val['id']+'"><td id="name">'+val['first_name']+" "+val['last_name']+'</td>' +
                    '<td id="birth_date">'+val['birth_date']+'</td><td><button type="button" class="btn btn-light"> \
                    <a href="/dashboard/details/'+val['id']+'/" class="btn-flat waves-effect" >View</a></button><button onclick="myfunction('+val['id']+')" style="margin-left:5px;" type="button" class="btn btn-light" id="delete_'+val['id']+'" data-ref='+val['id']+' style="cursor: pointer;">Delete</button></td></tr>')
                    ;

            });
        }


   });
   
});


// $("#delete").on("click", function(event){
//     //   event.preventDefault();
//       var pk = $(this).attr('data-ref');
//       var data = {
//           "csrfmiddlewaretoken":$("input[name='csrfmiddlewaretoken']").val()
//       };
//       $.ajax({
//           url: "/dashboard/delete/"+pk+"/",
//           type: "GET",
//           data: data,
//           contentType: "application/json; charset=utf-8",
//           dataType: "json",
//           success: function (data) {
//               if (data['success']){
//                 $("#list_table").load(window.location + " #list_table");
//               }
//           }
//       });
//   });
</script>
{% endblock %}